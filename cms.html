<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>è¨˜äº‹ç®¡ç† | å‡ºä¼šãˆã‚‹ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ ç·¨é›†éƒ¨</title>
  <style>
    :root {
      --green: #22c55e;
      --green-light: #f0fdf4;
      --green-dark: #15803d;
      --gray-50: #f9fafb;
      --gray-100: #f3f4f6;
      --gray-200: #e5e7eb;
      --gray-300: #d1d5db;
      --gray-400: #9ca3af;
      --gray-500: #6b7280;
      --gray-600: #4b5563;
      --gray-700: #374151;
      --gray-800: #1f2937;
      --gray-900: #111827;
      --red: #ef4444;
      --yellow: #f59e0b;
      --blue: #3b82f6;
      --gold: #f59e0b;
      --silver: #9ca3af;
      --bronze: #d97706;
      --orange: #f97316;
      --purple: #8b5cf6;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Hiragino Sans', 'Noto Sans JP', sans-serif;
      background: var(--gray-50);
      color: var(--gray-800);
      line-height: 1.6;
    }

    header {
      background: linear-gradient(135deg, var(--green), var(--green-dark));
      color: white;
      padding: 1.5rem 2rem;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      position: sticky;
      top: 0;
      z-index: 100;
    }

    header h1 {
      font-size: 1.25rem;
      font-weight: 700;
      display: flex;
      align-items: center;
      gap: 0.75rem;
    }

    header h1 span.badge {
      background: rgba(255,255,255,0.2);
      padding: 0.2rem 0.6rem;
      border-radius: 6px;
      font-size: 0.75rem;
      font-weight: 500;
    }

    .toolbar {
      background: white;
      border-bottom: 1px solid var(--gray-200);
      padding: 1rem 2rem;
      display: flex;
      align-items: center;
      gap: 1rem;
      flex-wrap: wrap;
    }

    .toolbar .stats {
      display: flex;
      gap: 1.5rem;
      margin-right: auto;
    }

    .toolbar .stat {
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    .toolbar .stat-value {
      font-size: 1.5rem;
      font-weight: 700;
      color: var(--green-dark);
    }

    .toolbar .stat-label {
      font-size: 0.75rem;
      color: var(--gray-500);
    }

    .toolbar .view-toggle {
      display: flex;
      border: 1px solid var(--gray-300);
      border-radius: 8px;
      overflow: hidden;
    }

    .toolbar .view-toggle button {
      padding: 0.5rem 1rem;
      border: none;
      background: white;
      cursor: pointer;
      font-size: 0.875rem;
      color: var(--gray-600);
      transition: all 0.15s;
    }

    .toolbar .view-toggle button.active {
      background: var(--green);
      color: white;
    }

    .toolbar .view-toggle button:hover:not(.active) {
      background: var(--gray-100);
    }

    .filter-bar {
      background: white;
      border-bottom: 1px solid var(--gray-200);
      padding: 0.75rem 2rem;
      display: flex;
      gap: 0.5rem;
      flex-wrap: wrap;
    }

    .filter-bar button {
      padding: 0.4rem 1rem;
      border: 1px solid var(--gray-300);
      border-radius: 20px;
      background: white;
      cursor: pointer;
      font-size: 0.8125rem;
      color: var(--gray-600);
      transition: all 0.15s;
      display: inline-flex;
      align-items: center;
      gap: 0.375rem;
    }

    .filter-bar button.active {
      border-color: var(--green);
      background: var(--green-light);
      color: var(--green-dark);
    }

    .filter-bar button.active-popular {
      border-color: var(--orange);
      background: #fff7ed;
      color: #c2410c;
    }

    .filter-bar button.active-pinned {
      border-color: var(--blue);
      background: #eff6ff;
      color: #1d4ed8;
    }

    .filter-bar button:hover:not(.active):not(.active-popular):not(.active-pinned) {
      border-color: var(--gray-400);
      background: var(--gray-100);
    }

    .filter-bar .separator {
      width: 1px;
      background: var(--gray-200);
      margin: 0 0.25rem;
    }

    /* Featured TOP3 Section */
    .featured-section {
      background: linear-gradient(135deg, #f0fdf4 0%, #ecfdf5 50%, #f0f9ff 100%);
      border-bottom: 2px solid var(--gray-200);
      padding: 2rem 2rem 2.5rem;
    }

    .featured-inner {
      max-width: 1400px;
      margin: 0 auto;
    }

    .featured-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 1.25rem;
    }

    .featured-header h2 {
      font-size: 1.125rem;
      font-weight: 700;
      color: var(--green-dark);
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .featured-header .auto-label {
      font-size: 0.7rem;
      font-weight: 500;
      color: var(--gray-500);
      background: var(--gray-100);
      padding: 0.15rem 0.5rem;
      border-radius: 4px;
    }

    .featured-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 1.25rem;
    }

    .featured-card {
      background: white;
      border-radius: 12px;
      overflow: hidden;
      box-shadow: 0 2px 8px rgba(0,0,0,0.08);
      transition: box-shadow 0.2s, transform 0.2s;
      cursor: pointer;
      position: relative;
    }

    .featured-card:hover {
      box-shadow: 0 8px 24px rgba(0,0,0,0.12);
      transform: translateY(-3px);
    }

    .featured-card .rank-badge {
      position: absolute;
      top: 0.75rem;
      left: 0.75rem;
      width: 36px;
      height: 36px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 800;
      font-size: 1rem;
      color: white;
      z-index: 2;
      box-shadow: 0 2px 6px rgba(0,0,0,0.25);
    }

    .featured-card .rank-badge.rank-1 {
      background: linear-gradient(135deg, #f59e0b, #d97706);
    }
    .featured-card .rank-badge.rank-2 {
      background: linear-gradient(135deg, #9ca3af, #6b7280);
    }
    .featured-card .rank-badge.rank-3 {
      background: linear-gradient(135deg, #d97706, #b45309);
    }

    .featured-card .new-label {
      position: absolute;
      top: 0.75rem;
      right: 0.75rem;
      background: var(--red);
      color: white;
      font-size: 0.65rem;
      font-weight: 700;
      padding: 0.2rem 0.5rem;
      border-radius: 4px;
      z-index: 2;
      letter-spacing: 0.05em;
    }

    .featured-card .feat-thumb-wrapper {
      position: relative;
      width: 100%;
      aspect-ratio: 16/9;
      background: var(--gray-100);
      overflow: hidden;
    }

    .featured-card .feat-thumb-wrapper img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: block;
    }

    .featured-card .feat-thumb-wrapper .no-thumb {
      width: 100%;
      height: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--gray-400);
      font-size: 0.875rem;
      flex-direction: column;
      gap: 0.5rem;
    }

    .featured-card .feat-body {
      padding: 1rem 1.25rem;
    }

    .featured-card .feat-body h3 {
      font-size: 0.9375rem;
      font-weight: 600;
      line-height: 1.5;
      margin-bottom: 0.5rem;
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
      overflow: hidden;
    }

    .featured-card .feat-body .feat-desc {
      font-size: 0.8125rem;
      color: var(--gray-500);
      line-height: 1.5;
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
      overflow: hidden;
    }

    .featured-card .feat-body .feat-meta {
      font-size: 0.75rem;
      color: var(--gray-400);
      margin-top: 0.5rem;
    }

    .featured-card .feat-body .feat-actions {
      display: flex;
      gap: 0.5rem;
      margin-top: 0.75rem;
      padding-top: 0.75rem;
      border-top: 1px solid var(--gray-100);
    }

    .featured-card .feat-body .feat-actions a {
      padding: 0.35rem 0.75rem;
      border-radius: 6px;
      font-size: 0.75rem;
      text-decoration: none;
      transition: all 0.15s;
    }

    .featured-card .feat-body .feat-actions a.primary {
      background: var(--green);
      color: white;
    }

    .featured-card .feat-body .feat-actions a.primary:hover {
      background: var(--green-dark);
    }

    .featured-card .feat-body .feat-actions a.secondary {
      background: var(--gray-100);
      color: var(--gray-600);
    }

    .featured-card .feat-body .feat-actions a.secondary:hover {
      background: var(--gray-200);
    }

    /* Toast */
    .toast {
      position: fixed;
      bottom: 2rem;
      right: 2rem;
      background: var(--gray-800);
      color: white;
      padding: 0.75rem 1.25rem;
      border-radius: 8px;
      font-size: 0.875rem;
      z-index: 300;
      animation: toastIn 0.3s ease, toastOut 0.3s ease 2.7s forwards;
    }

    @keyframes toastIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    @keyframes toastOut {
      from { opacity: 1; transform: translateY(0); }
      to { opacity: 0; transform: translateY(20px); }
    }

    main {
      padding: 1.5rem 2rem;
      max-width: 1400px;
      margin: 0 auto;
    }

    .grid-view {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
      gap: 1.25rem;
    }

    .list-view {
      display: flex;
      flex-direction: column;
      gap: 0.75rem;
    }

    .card {
      background: white;
      border-radius: 12px;
      overflow: hidden;
      box-shadow: 0 1px 3px rgba(0,0,0,0.06), 0 1px 2px rgba(0,0,0,0.04);
      transition: box-shadow 0.2s, transform 0.2s;
      cursor: default;
      position: relative;
    }

    .card:hover {
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
      transform: translateY(-2px);
    }

    .card.is-pinned {
      border: 2px solid var(--blue);
    }

    .card.is-popular {
      border: 2px solid var(--orange);
    }

    .card.is-pinned.is-popular {
      border: 2px solid var(--purple);
    }

    .card .thumbnail-wrapper {
      position: relative;
      width: 100%;
      aspect-ratio: 16/9;
      background: var(--gray-100);
      overflow: hidden;
    }

    .card .thumbnail-wrapper img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: block;
    }

    .card .thumbnail-wrapper .no-thumb {
      width: 100%;
      height: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--gray-400);
      font-size: 0.875rem;
      flex-direction: column;
      gap: 0.5rem;
    }

    .card .thumbnail-wrapper .no-thumb svg {
      width: 36px;
      height: 36px;
      opacity: 0.5;
    }

    .card .thumbnail-wrapper .status-badge {
      position: absolute;
      top: 0.5rem;
      right: 0.5rem;
      padding: 0.2rem 0.6rem;
      border-radius: 4px;
      font-size: 0.7rem;
      font-weight: 600;
      text-transform: uppercase;
    }

    .card .thumbnail-wrapper .status-badge.published {
      background: rgba(34, 197, 94, 0.9);
      color: white;
    }

    .card .thumbnail-wrapper .status-badge.draft {
      background: rgba(245, 158, 11, 0.9);
      color: white;
    }

    .card .thumbnail-wrapper .thumb-indicator {
      position: absolute;
      bottom: 0.5rem;
      left: 0.5rem;
      padding: 0.15rem 0.5rem;
      border-radius: 4px;
      font-size: 0.65rem;
      font-weight: 600;
    }

    .card .thumbnail-wrapper .thumb-indicator.has-thumb {
      background: rgba(34, 197, 94, 0.9);
      color: white;
    }

    .card .thumbnail-wrapper .thumb-indicator.no-thumb-badge {
      background: rgba(239, 68, 68, 0.9);
      color: white;
    }

    /* Card overlay badges */
    .card .card-badges {
      position: absolute;
      top: 0.5rem;
      left: 0.5rem;
      display: flex;
      gap: 0.375rem;
      z-index: 3;
    }

    .card .card-badges .badge-item {
      padding: 0.2rem 0.5rem;
      border-radius: 4px;
      font-size: 0.65rem;
      font-weight: 700;
      color: white;
    }

    .card .card-badges .badge-popular {
      background: rgba(249, 115, 22, 0.9);
    }

    .card .card-badges .badge-pinned {
      background: rgba(59, 130, 246, 0.9);
    }

    .card .card-body {
      padding: 1rem;
    }

    .card .card-body h3 {
      font-size: 0.9375rem;
      font-weight: 600;
      line-height: 1.4;
      margin-bottom: 0.5rem;
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
      overflow: hidden;
    }

    .card .card-body .meta {
      display: flex;
      gap: 0.75rem;
      flex-wrap: wrap;
      margin-bottom: 0.5rem;
    }

    .card .card-body .meta span {
      font-size: 0.75rem;
      color: var(--gray-500);
    }

    .card .card-body .tags {
      display: flex;
      gap: 0.375rem;
      flex-wrap: wrap;
    }

    .card .card-body .tags span {
      padding: 0.15rem 0.5rem;
      background: var(--gray-100);
      border-radius: 4px;
      font-size: 0.7rem;
      color: var(--gray-600);
    }

    .card .card-body .description {
      font-size: 0.8125rem;
      color: var(--gray-500);
      margin-top: 0.5rem;
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
      overflow: hidden;
    }

    .card .card-body .actions {
      display: flex;
      gap: 0.5rem;
      margin-top: 0.75rem;
      padding-top: 0.75rem;
      border-top: 1px solid var(--gray-100);
      align-items: center;
      flex-wrap: wrap;
    }

    .card .card-body .actions a {
      padding: 0.35rem 0.75rem;
      border-radius: 6px;
      font-size: 0.75rem;
      text-decoration: none;
      transition: all 0.15s;
    }

    .card .card-body .actions a.primary {
      background: var(--green);
      color: white;
    }

    .card .card-body .actions a.primary:hover {
      background: var(--green-dark);
    }

    .card .card-body .actions a.secondary {
      background: var(--gray-100);
      color: var(--gray-600);
    }

    .card .card-body .actions a.secondary:hover {
      background: var(--gray-200);
    }

    .actions .spacer {
      flex: 1;
    }

    .toggle-btn {
      display: inline-flex;
      align-items: center;
      gap: 0.25rem;
      padding: 0.3rem 0.6rem;
      border-radius: 6px;
      font-size: 0.7rem;
      font-weight: 500;
      cursor: pointer;
      border: 1px solid var(--gray-300);
      background: white;
      color: var(--gray-500);
      transition: all 0.15s;
      white-space: nowrap;
    }

    .toggle-btn:hover {
      border-color: var(--gray-400);
      background: var(--gray-50);
    }

    .toggle-btn.popular-active {
      border-color: var(--orange);
      background: #fff7ed;
      color: #c2410c;
    }

    .toggle-btn.popular-active:hover {
      background: #ffedd5;
    }

    .toggle-btn.pin-active {
      border-color: var(--blue);
      background: #eff6ff;
      color: #1d4ed8;
    }

    .toggle-btn.pin-active:hover {
      background: #dbeafe;
    }

    .list-view .card {
      display: flex;
      flex-direction: row;
    }

    .list-view .card .thumbnail-wrapper {
      width: 200px;
      min-width: 200px;
      aspect-ratio: auto;
      height: 120px;
    }

    .list-view .card .card-body {
      flex: 1;
      display: flex;
      flex-direction: column;
      justify-content: center;
    }

    .list-view .card .card-body h3 {
      -webkit-line-clamp: 1;
    }

    .empty-state {
      text-align: center;
      padding: 4rem 2rem;
      color: var(--gray-400);
    }

    .empty-state svg {
      width: 64px;
      height: 64px;
      margin-bottom: 1rem;
      opacity: 0.5;
    }

    .modal-overlay {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.6);
      z-index: 200;
      align-items: center;
      justify-content: center;
    }

    .modal-overlay.active {
      display: flex;
    }

    .modal {
      background: white;
      border-radius: 12px;
      max-width: 600px;
      width: 90%;
      max-height: 80vh;
      overflow-y: auto;
      padding: 1.5rem;
    }

    .modal h2 {
      font-size: 1.125rem;
      margin-bottom: 1rem;
    }

    .modal .thumb-preview {
      width: 100%;
      border-radius: 8px;
      margin-bottom: 1rem;
    }

    .modal .close-btn {
      float: right;
      background: none;
      border: none;
      font-size: 1.5rem;
      cursor: pointer;
      color: var(--gray-400);
      padding: 0.25rem;
    }

    .modal .close-btn:hover {
      color: var(--gray-700);
    }

    @media (max-width: 768px) {
      header { padding: 1rem; }
      .toolbar { padding: 0.75rem 1rem; }
      .filter-bar { padding: 0.5rem 1rem; }
      main { padding: 1rem; }
      .grid-view { grid-template-columns: 1fr; }
      .list-view .card { flex-direction: column; }
      .list-view .card .thumbnail-wrapper { width: 100%; height: auto; aspect-ratio: 16/9; }
      .featured-section { padding: 1.25rem 1rem; }
      .featured-grid { grid-template-columns: 1fr; }
      .featured-header { flex-direction: column; gap: 0.75rem; align-items: flex-start; }
    }
  </style>
</head>
<body>
  <header>
    <h1>
      å‡ºä¼šãˆã‚‹ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ ç·¨é›†éƒ¨
      <span class="badge">è¨˜äº‹ç®¡ç†CMS</span>
    </h1>
  </header>

  <div class="toolbar">
    <div class="stats">
      <div class="stat">
        <span class="stat-value" id="total-count">0</span>
        <span class="stat-label">å…¨è¨˜äº‹</span>
      </div>
      <div class="stat">
        <span class="stat-value" id="popular-count" style="color: var(--orange);">0</span>
        <span class="stat-label">äººæ°—</span>
      </div>
      <div class="stat">
        <span class="stat-value" id="pinned-count" style="color: var(--blue);">0</span>
        <span class="stat-label">ãŠã™ã™ã‚</span>
      </div>
      <div class="stat">
        <span class="stat-value" id="thumb-count">0</span>
        <span class="stat-label">ã‚µãƒ ãƒã‚ã‚Š</span>
      </div>
      <div class="stat">
        <span class="stat-value" id="no-thumb-count" style="color: var(--red);">0</span>
        <span class="stat-label">ã‚µãƒ ãƒãªã—</span>
      </div>
    </div>
    <button onclick="resetAllSettings()" style="padding:0.4rem 0.75rem;border:1px solid var(--gray-300);border-radius:6px;background:white;cursor:pointer;font-size:0.75rem;color:var(--gray-500);" title="äººæ°—ãƒ»ãŠã™ã™ã‚ã‚’ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã«æˆ»ã™">ãƒªã‚»ãƒƒãƒˆ</button>
    <div class="view-toggle">
      <button class="active" onclick="setView('grid')">ã‚°ãƒªãƒƒãƒ‰</button>
      <button onclick="setView('list')">ãƒªã‚¹ãƒˆ</button>
    </div>
  </div>

  <div class="filter-bar">
    <button class="active" onclick="setFilter('all', this)">ã™ã¹ã¦</button>
    <button onclick="setFilter('popular', this)">ğŸ”¥ äººæ°—</button>
    <button onclick="setFilter('pinned', this)">ğŸ“Œ ãŠã™ã™ã‚</button>
    <div class="separator"></div>
    <button onclick="setFilter('has-thumb', this)">ã‚µãƒ ãƒã‚ã‚Š</button>
    <button onclick="setFilter('no-thumb', this)">ã‚µãƒ ãƒãªã—</button>
    <div class="separator"></div>
    <button onclick="setFilter('è»¢è·ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ', this)">è»¢è·ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ</button>
    <button onclick="setFilter('é¢æ¥å¯¾ç­–', this)">é¢æ¥å¯¾ç­–</button>
    <button onclick="setFilter('ã‚­ãƒ£ãƒªã‚¢', this)">ã‚­ãƒ£ãƒªã‚¢</button>
    <button onclick="setFilter('å¹´åãƒ»å¾…é‡', this)">å¹´åãƒ»å¾…é‡</button>
  </div>

  <!-- æ–°ç€ TOP3 ã‚»ã‚¯ã‚·ãƒ§ãƒ³ (è‡ªå‹•: å…¬é–‹æ—¥é †) -->
  <section class="featured-section">
    <div class="featured-inner">
      <div class="featured-header">
        <h2>
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg>
          æ–°ç€ TOP3
          <span class="auto-label">å…¬é–‹æ—¥é †ãƒ»è‡ªå‹•</span>
        </h2>
      </div>
      <div class="featured-grid" id="featured-container"></div>
    </div>
  </section>

  <main>
    <div id="article-container" class="grid-view"></div>
  </main>

  <!-- è¨˜äº‹è©³ç´°ãƒ¢ãƒ¼ãƒ€ãƒ« -->
  <div class="modal-overlay" id="modal" onclick="closeModal(event)">
    <div class="modal">
      <button class="close-btn" onclick="document.getElementById('modal').classList.remove('active')">&times;</button>
      <h2 id="modal-title"></h2>
      <img id="modal-thumb" class="thumb-preview" />
      <div id="modal-content"></div>
    </div>
  </div>

  <script>
    const articles = [
      {
        file: "è»¢è·ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ_è¤‡æ•°ç™»éŒ²_ãƒ¡ãƒªãƒƒãƒˆ.md",
        title: "è»¢è·ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã¯è¤‡æ•°ç™»éŒ²ã™ã¹ãï¼Ÿä½µç”¨ã®ãƒ¡ãƒªãƒƒãƒˆã¨æ³¨æ„ç‚¹",
        description: "è»¢è·ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã¯1ç¤¾ã ã‘ã§ã„ã„ï¼Ÿè¤‡æ•°ç™»éŒ²ã®ãƒ¡ãƒªãƒƒãƒˆãƒ»ãƒ‡ãƒ¡ãƒªãƒƒãƒˆã¨ã€ä½µç”¨ã™ã‚‹éš›ã®æ³¨æ„ç‚¹ã‚’çµŒé¨“è€…ã®ãƒ‡ãƒ¼ã‚¿ã‚’ã‚‚ã¨ã«è§£èª¬ã—ã¾ã™ã€‚",
        category: "è»¢è·ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ",
        keyword: "è»¢è·ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ è¤‡æ•°",
        published: "2026-02-18",
        thumbnail: "output/images/agent-multiple-registration-thumbnail.png",
        cmsThumb: true,
        cmsUrl: "https://deaeru-agent.jp/articles/article-mlsx5wc4-iafsdh",
        popular: true
      },
      {
        file: "è»¢è·ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ_é¸ã³æ–¹.md",
        title: "è»¢è·ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®é¸ã³æ–¹ï½œå¤±æ•—ã—ãªã„5ã¤ã®ãƒã‚¤ãƒ³ãƒˆ",
        description: "è»¢è·ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆé¸ã³ã§å¤±æ•—ã—ãŸããªã„æ–¹ã¸ã€‚è‡ªåˆ†ã«åˆã†ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®è¦‹æ¥µã‚æ–¹ã¨ã€åŠ¹ç‡çš„ã«ãƒ™ã‚¹ãƒˆãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼ã‚’è¦‹ã¤ã‘ã‚‹æ–¹æ³•ã‚’è§£èª¬ã—ã¾ã™ã€‚",
        category: "è»¢è·ãƒ»ã‚­ãƒ£ãƒªã‚¢",
        keyword: "è»¢è·ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ é¸ã³æ–¹",
        published: "2026-02-18",
        thumbnail: "output/images/agent-how-to-choose-5points-thumbnail.png",
        cmsThumb: true,
        cmsUrl: "https://deaeru-agent.jp/articles/5-n2xmx6",
        cmsId: "49700b4c-ad0e-4bb7-b5b3-690c5bf5c53d",
        popular: true
      },
      {
        file: "è»¢è·ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãŠã™ã™ã‚_10é¸.md",
        title: "ã€2026å¹´æœ€æ–°ã€‘è»¢è·ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãŠã™ã™ã‚10é¸ï½œå¤±æ•—ã—ãªã„é¸ã³æ–¹",
        description: "2026å¹´æœ€æ–°ã®è»¢è·ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãŠã™ã™ã‚10é¸ã‚’å³é¸ã€‚å„ã‚µãƒ¼ãƒ“ã‚¹ã®ç‰¹å¾´ãƒ»å¼·ã¿ã‚’æ¯”è¼ƒã—ã€ã‚ãªãŸã«æœ€é©ãªã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®é¸ã³æ–¹ã‚’è§£èª¬ã—ã¾ã™ã€‚",
        category: "è»¢è·ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ",
        keyword: "è»¢è·ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ ãŠã™ã™ã‚ 10é¸",
        published: "2026-02-21",
        thumbnail: "output/images/agent-best-10-picks-thumbnail.png",
        cmsThumb: true,
        cmsUrl: "#",
        popular: true
      },
      {
        file: "è»¢è·ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ_åˆã‚ãªã„_å¯¾å‡¦æ³•.md",
        title: "è»¢è·ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãŒåˆã‚ãªã„ã¨æ„Ÿã˜ãŸã‚‰ï½œæ‹…å½“å¤‰æ›´ãƒ»é€€ä¼šã®åˆ¤æ–­åŸºæº–ã¨å¯¾å‡¦æ³•",
        description: "è»¢è·ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®æ‹…å½“è€…ãŒåˆã‚ãªã„ã¨æ„Ÿã˜ã¦ã„ã‚‹æ–¹ã¸ã€‚æˆ‘æ…¢ã™ã¹ãã‹å¤‰æ›´ã™ã¹ãã‹ã®åˆ¤æ–­åŸºæº–ã¨ã€è§’ã‚’ç«‹ã¦ãšã«å¯¾å‡¦ã™ã‚‹æ–¹æ³•ã‚’è§£èª¬ã—ã¾ã™ã€‚",
        category: "è»¢è·ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ",
        keyword: "è»¢è·ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ åˆã‚ãªã„",
        published: "2026-02-18",
        thumbnail: "thumbnails/07-agent-awanai.png",
        cmsThumb: true,
        cmsUrl: "https://deaeru-agent.jp/articles/article-mlsx5tlh-qo518q"
      },
      {
        file: "è»¢è·_é¢æ¥å¯¾ç­–_å®Œå…¨ã‚¬ã‚¤ãƒ‰.md",
        title: "è»¢è·é¢æ¥ã§å—ã‹ã‚‹äººãŒã‚„ã£ã¦ã„ã‚‹7ã¤ã®æº–å‚™ï½œã‚ˆãèã‹ã‚Œã‚‹è³ªå•ã¨å›ç­”ä¾‹",
        description: "è»¢è·ã®é¢æ¥ã§è½ã¡ã¦ã—ã¾ã†æ–¹ã¸ã€‚é¢æ¥å®˜ãŒè¦‹ã¦ã„ã‚‹ãƒã‚¤ãƒ³ãƒˆã¨ã€å—ã‹ã‚‹äººãŒå®Ÿè·µã—ã¦ã„ã‚‹7ã¤ã®æº–å‚™ã‚’å…·ä½“çš„ãªå›ç­”ä¾‹ã¤ãã§è§£èª¬ã—ã¾ã™ã€‚",
        category: "é¢æ¥å¯¾ç­–",
        keyword: "è»¢è· é¢æ¥å¯¾ç­–",
        published: "2026-02-18",
        thumbnail: "output/images/agent-complete-guide-7points-thumbnail.png",
        cmsThumb: true,
        cmsUrl: "https://deaeru-agent.jp/articles/7-nzxhy0",
        popular: true
      },
      {
        file: "è»¢è·_è‡ªå·±åˆ†æ_ã‚„ã‚Šæ–¹.md",
        title: "è»¢è·ã®è‡ªå·±åˆ†æã®ã‚„ã‚Šæ–¹ï½œå¼·ã¿ãƒ»é©è·ãŒè¦‹ã¤ã‹ã‚‹4ã¤ã®ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯",
        description: "è»¢è·ã§è‡ªå·±åˆ†æã®ã‚„ã‚Šæ–¹ãŒã‚ã‹ã‚‰ãªã„æ–¹ã¸ã€‚è‡ªåˆ†ã®å¼·ã¿ãƒ»ä¾¡å€¤è¦³ãƒ»é©è·ã‚’è¦‹ã¤ã‘ã‚‹ãŸã‚ã®å…·ä½“çš„ãªãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã¨ã€ãƒ—ãƒ­ã«ç›¸è«‡ã™ã‚‹æ–¹æ³•ã‚’è§£èª¬ã—ã¾ã™ã€‚",
        category: "ã‚­ãƒ£ãƒªã‚¢",
        keyword: "è»¢è· è‡ªå·±åˆ†æ ã‚„ã‚Šæ–¹",
        published: "2026-02-18",
        thumbnail: "thumbnails/03-jiko-bunseki.png",
        cmsThumb: true,
        cmsUrl: "https://deaeru-agent.jp/articles/4-y45bre"
      },
      {
        file: "è»¢è·_æ›¸é¡é¸è€ƒ_é€šéç‡ã‚¢ãƒƒãƒ—.md",
        title: "è»¢è·ã®æ›¸é¡é¸è€ƒãŒé€šã‚‰ãªã„åŸå› ã¨é€šéç‡ã‚’ä¸Šã’ã‚‹7ã¤ã®æ”¹å–„ãƒã‚¤ãƒ³ãƒˆ",
        description: "è»¢è·ã®æ›¸é¡é¸è€ƒã§è½ã¡ã¦ã—ã¾ã†æ–¹ã¸ã€‚æ¡ç”¨æ‹…å½“è€…ãŒè¦‹ã¦ã„ã‚‹ãƒã‚¤ãƒ³ãƒˆã¨ã€é€šéç‡ã‚’ä¸Šã’ã‚‹ãŸã‚ã®è·å‹™çµŒæ­´æ›¸ãƒ»å±¥æ­´æ›¸ã®æ›¸ãæ–¹ã‚’å…·ä½“ä¾‹ã¤ãã§è§£èª¬ã—ã¾ã™ã€‚",
        category: "ã‚­ãƒ£ãƒªã‚¢",
        keyword: "è»¢è· æ›¸é¡é¸è€ƒ é€šã‚‰ãªã„",
        published: "2026-02-18",
        thumbnail: "thumbnails/04-shorui-senko.png",
        cmsThumb: true,
        cmsUrl: "https://deaeru-agent.jp/articles/7-s7h86d",
        cmsId: "ef212fde-b4b0-4cc9-8390-1aa370552057"
      },
      {
        file: "è»¢è·_å¹´åã‚¢ãƒƒãƒ—_äº¤æ¸‰è¡“.md",
        title: "è»¢è·ã§å¹´åã‚¢ãƒƒãƒ—ã‚’å®Ÿç¾ã™ã‚‹äº¤æ¸‰è¡“ï½œãƒ—ãƒ­ãŒæ•™ãˆã‚‹5ã¤ã®ã‚¹ãƒ†ãƒƒãƒ—",
        description: "è»¢è·ã§å¹´åã‚’ä¸Šã’ãŸã„æ–¹ã¸ã€‚å¹´åäº¤æ¸‰ã®ã‚¿ã‚¤ãƒŸãƒ³ã‚°ãƒ»ä¼ãˆæ–¹ãƒ»ç›¸å ´ã®èª¿ã¹æ–¹ã‚’ç¾å ´ç›®ç·šã§è§£èª¬ã€‚å¹´åäº¤æ¸‰ã‚’æˆåŠŸã•ã›ã‚‹å…·ä½“çš„ãª5ã‚¹ãƒ†ãƒƒãƒ—ã‚’ç´¹ä»‹ã—ã¾ã™ã€‚",
        category: "å¹´åãƒ»å¾…é‡",
        keyword: "è»¢è· å¹´åã‚¢ãƒƒãƒ—",
        published: "2026-02-18",
        thumbnail: "thumbnails/11-nenshu-up.png",
        cmsThumb: true,
        cmsUrl: "https://deaeru-agent.jp/articles/5-jpsp93",
        cmsId: "1a8d19ef-dd62-4ea2-9fa9-067a77290652"
      },
      {
        file: "è»¢è·_å†…å®š_è¤‡æ•°_æ¯”è¼ƒ_é¸ã³æ–¹.md",
        title: "è»¢è·ã§å†…å®šã‚’è¤‡æ•°ã‚‚ã‚‰ã£ãŸã¨ãã®æ¯”è¼ƒæ–¹æ³•ï½œå¾Œæ‚”ã—ãªã„é¸ã³æ–¹5ã¤ã®åŸºæº–",
        description: "è»¢è·ã§å†…å®šãŒè¤‡æ•°å‡ºã¦è¿·ã£ã¦ã„ã‚‹æ–¹ã¸ã€‚å¹´åãƒ»ä»•äº‹å†…å®¹ãƒ»ç¤¾é¢¨ãªã©ã€å¾Œæ‚”ã—ãªã„ä¼šç¤¾é¸ã³ã®ãŸã‚ã®æ¯”è¼ƒåŸºæº–ã¨åˆ¤æ–­ã®ã‚³ãƒ„ã‚’è§£èª¬ã—ã¾ã™ã€‚",
        category: "ã‚­ãƒ£ãƒªã‚¢",
        keyword: "è»¢è· å†…å®š è¤‡æ•° æ¯”è¼ƒ",
        published: "2026-02-18",
        thumbnail: "thumbnails/05-naitei-hikaku.png",
        cmsThumb: true,
        cmsUrl: "https://deaeru-agent.jp/articles/5-cqrtg8"
      },
      {
        file: "åˆã‚ã¦_è»¢è·_ã‚„ã‚Šæ–¹_å®Œå…¨ã‚¬ã‚¤ãƒ‰.md",
        title: "åˆã‚ã¦ã®è»¢è·ã‚’æˆåŠŸã•ã›ã‚‹å®Œå…¨ã‚¬ã‚¤ãƒ‰ï½œæº–å‚™ã‹ã‚‰å†…å®šã¾ã§ã®æµã‚Œã‚’è§£èª¬",
        description: "åˆã‚ã¦ã®è»¢è·ã§ä¸å®‰ãªæ–¹ã¸ã€‚ä½•ã‹ã‚‰å§‹ã‚ã‚Œã°ã„ã„ã‹ã€æº–å‚™ã‹ã‚‰å†…å®šãƒ»é€€è·ã¾ã§ã®å…¨ã‚¹ãƒ†ãƒƒãƒ—ã‚’æ™‚ç³»åˆ—ã§è§£èª¬ã€‚åˆè»¢è·ã§ã‚ˆãã‚ã‚‹å¤±æ•—ã‚‚ç´¹ä»‹ã—ã¾ã™ã€‚",
        category: "è»¢è·ãƒ»ã‚­ãƒ£ãƒªã‚¢",
        keyword: "åˆã‚ã¦ è»¢è· ã‚„ã‚Šæ–¹",
        published: "2026-02-18",
        thumbnail: "thumbnails/02-hajimete-tenshoku.png",
        cmsThumb: true,
        cmsUrl: "https://deaeru-agent.jp/articles/article-mlsx5dfw-avgm59"
      },
      {
        file: "å††æº€é€€è·_ä¼ãˆæ–¹_ã‚¿ã‚¤ãƒŸãƒ³ã‚°.md",
        title: "å††æº€é€€è·ã®ä¼ãˆæ–¹ã¨ãƒ™ã‚¹ãƒˆãªã‚¿ã‚¤ãƒŸãƒ³ã‚°ï½œãƒˆãƒ©ãƒ–ãƒ«ã‚’é¿ã‘ã‚‹é€€è·ãƒãƒ‹ãƒ¥ã‚¢ãƒ«",
        description: "é€€è·ã‚’ä¼ãˆã‚‹ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã‚„ä¸Šå¸ã¸ã®åˆ‡ã‚Šå‡ºã—æ–¹ã§æ‚©ã‚“ã§ã„ã‚‹æ–¹ã¸ã€‚å††æº€ã«ä¼šç¤¾ã‚’è¾ã‚ã‚‹ãŸã‚ã®æ‰‹é †ãƒ»ä¼ãˆæ–¹ãƒ»å¼•ãæ­¢ã‚ã‚‰ã‚ŒãŸã¨ãã®å¯¾å‡¦æ³•ã‚’è§£èª¬ã—ã¾ã™ã€‚",
        category: "ã‚­ãƒ£ãƒªã‚¢",
        keyword: "å††æº€é€€è· ä¼ãˆæ–¹",
        published: "2026-02-18",
        thumbnail: "thumbnails/01-enman-taishoku.png",
        cmsThumb: true,
        cmsUrl: "https://deaeru-agent.jp/articles/article-mlsx59zs-5p0jtm"
      },
      {
        file: "è»¢è·ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãŠã™ã™ã‚_20ä»£.md",
        title: "è»¢è·ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãŠã™ã™ã‚5é¸ï½œ20ä»£ãƒ»ç¬¬äºŒæ–°å’å‘ã‘",
        description: "20ä»£ãƒ»ç¬¬äºŒæ–°å’ã§è»¢è·ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆé¸ã³ã«è¿·ã£ã¦ã„ã‚‹æ–¹ã¸ã€‚è‡ªåˆ†ã«åˆã£ãŸã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®é¸ã³æ–¹ã¨ã€ãŠã™ã™ã‚ã‚µãƒ¼ãƒ“ã‚¹ã‚’çµŒé¨“è€…ç›®ç·šã§ç´¹ä»‹ã—ã¾ã™ã€‚",
        category: "è»¢è·ãƒ»ã‚­ãƒ£ãƒªã‚¢",
        keyword: "è»¢è·ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ ãŠã™ã™ã‚",
        published: "2026-02-14",
        thumbnail: "output/images/agent-best-5-twenties-thumbnail.png",
        cmsThumb: true,
        cmsUrl: "https://deaeru-agent.jp/articles/520-gtqdha",
        cmsId: "50eb208d-9d63-4463-abe6-8d865a22f78a",
        popular: true
      }
    ];

    let currentView = 'grid';
    let currentFilter = 'all';

    // --- äººæ°—ç®¡ç† (localStorage) ---
    function getDefaultPopular() {
      return new Set(articles.filter(a => a.popular).map(a => a.file));
    }

    function getPopularSet() {
      try {
        const saved = localStorage.getItem('cms_popular_articles');
        if (saved) return new Set(JSON.parse(saved));
      } catch(e) {}
      return getDefaultPopular();
    }

    function initPopularIfNeeded() {
      const saved = localStorage.getItem('cms_popular_articles');
      if (!saved) {
        savePopularSet(getDefaultPopular());
        return;
      }
      try {
        const parsed = JSON.parse(saved);
        if (!Array.isArray(parsed) || parsed.length === 0) {
          savePopularSet(getDefaultPopular());
        }
      } catch(e) {
        savePopularSet(getDefaultPopular());
      }
    }

    function resetAllSettings() {
      localStorage.removeItem('cms_popular_articles');
      localStorage.removeItem('cms_pinned_articles');
      initPopularIfNeeded();
      render();
      renderFeatured();
      showToast('è¨­å®šã‚’ãƒªã‚»ãƒƒãƒˆã—ã¾ã—ãŸ');
    }

    function savePopularSet(s) {
      localStorage.setItem('cms_popular_articles', JSON.stringify([...s]));
    }

    function togglePopular(file, evt) {
      evt.stopPropagation();
      const s = getPopularSet();
      if (s.has(file)) {
        s.delete(file);
        showToast('äººæ°—ã‚’è§£é™¤ã—ã¾ã—ãŸ');
      } else {
        s.add(file);
        showToast('ğŸ”¥ äººæ°—ã«è¿½åŠ ã—ã¾ã—ãŸ');
      }
      savePopularSet(s);
      render();
    }

    // --- ãŠã™ã™ã‚ãƒ”ãƒ³ç•™ã‚ç®¡ç† (localStorage) ---
    function getPinnedSet() {
      try {
        const saved = localStorage.getItem('cms_pinned_articles');
        if (saved) return new Set(JSON.parse(saved));
      } catch(e) {}
      return new Set();
    }

    function savePinnedSet(s) {
      localStorage.setItem('cms_pinned_articles', JSON.stringify([...s]));
    }

    function togglePinned(file, evt) {
      evt.stopPropagation();
      const s = getPinnedSet();
      if (s.has(file)) {
        s.delete(file);
        showToast('ãŠã™ã™ã‚ãƒ”ãƒ³ç•™ã‚ã‚’è§£é™¤ã—ã¾ã—ãŸ');
      } else {
        s.add(file);
        showToast('ğŸ“Œ ãŠã™ã™ã‚ã«ãƒ”ãƒ³ç•™ã‚ã—ã¾ã—ãŸ');
      }
      savePinnedSet(s);
      render();
    }

    // --- æ–°ç€TOP3 (å…¬é–‹æ—¥é †ã§è‡ªå‹•) ---
    function getNewest3() {
      return [...articles]
        .sort((a, b) => new Date(b.published) - new Date(a.published))
        .slice(0, 3);
    }

    function setView(view) {
      currentView = view;
      document.querySelectorAll('.view-toggle button').forEach(b => b.classList.remove('active'));
      event.target.classList.add('active');
      render();
    }

    function setFilter(filter, btn) {
      currentFilter = filter;
      document.querySelectorAll('.filter-bar button').forEach(b => {
        b.classList.remove('active', 'active-popular', 'active-pinned');
      });
      if (filter === 'popular') {
        btn.classList.add('active-popular');
      } else if (filter === 'pinned') {
        btn.classList.add('active-pinned');
      } else {
        btn.classList.add('active');
      }
      render();
    }

    function closeModal(e) {
      if (e.target === e.currentTarget) {
        document.getElementById('modal').classList.remove('active');
      }
    }

    function showDetail(idx) {
      const a = articles[idx];
      const popular = getPopularSet();
      const pinned = getPinnedSet();
      document.getElementById('modal-title').textContent = a.title;
      const img = document.getElementById('modal-thumb');
      img.src = a.thumbnail;
      img.alt = a.title;

      let statusHtml = '';
      if (popular.has(a.file)) statusHtml += '<span style="color:#c2410c;font-weight:600;">ğŸ”¥ äººæ°—</span> ';
      if (pinned.has(a.file)) statusHtml += '<span style="color:#1d4ed8;font-weight:600;">ğŸ“Œ ãŠã™ã™ã‚</span>';

      document.getElementById('modal-content').innerHTML = `
        <p style="color:var(--gray-500);font-size:0.875rem;margin-bottom:1rem;">${a.description}</p>
        ${statusHtml ? `<p style="margin-bottom:1rem;">${statusHtml}</p>` : ''}
        <table style="width:100%;font-size:0.8125rem;border-collapse:collapse;">
          <tr><td style="padding:0.5rem 0;color:var(--gray-500);width:120px;">ã‚«ãƒ†ã‚´ãƒª</td><td style="padding:0.5rem 0;">${a.category}</td></tr>
          <tr><td style="padding:0.5rem 0;color:var(--gray-500);">ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰</td><td style="padding:0.5rem 0;">${a.keyword}</td></tr>
          <tr><td style="padding:0.5rem 0;color:var(--gray-500);">å…¬é–‹æ—¥</td><td style="padding:0.5rem 0;">${a.published}</td></tr>
          <tr><td style="padding:0.5rem 0;color:var(--gray-500);">ãƒ•ã‚¡ã‚¤ãƒ«</td><td style="padding:0.5rem 0;word-break:break-all;"><code>${a.file}</code></td></tr>
          <tr><td style="padding:0.5rem 0;color:var(--gray-500);">ã‚µãƒ ãƒ(CMS)</td><td style="padding:0.5rem 0;">${a.cmsThumb ? '<span style="color:var(--green);">è¨­å®šæ¸ˆã¿</span>' : '<span style="color:var(--red);">æœªè¨­å®š</span>'}</td></tr>
        </table>
        <div style="margin-top:1rem;display:flex;gap:0.5rem;">
          <a href="${a.cmsUrl}" target="_blank" style="padding:0.5rem 1rem;background:var(--green);color:white;border-radius:6px;text-decoration:none;font-size:0.8125rem;">CMSè¨˜äº‹ã‚’é–‹ã</a>
        </div>
      `;
      document.getElementById('modal').classList.add('active');
    }

    function renderFeatured() {
      const container = document.getElementById('featured-container');
      const newest3 = getNewest3();
      const today = new Date().toISOString().slice(0, 10);

      container.innerHTML = newest3.map((a, i) => {
        const realIdx = articles.indexOf(a);
        const rankClass = `rank-${i + 1}`;
        const isNew = a.published === today;
        return `
        <div class="featured-card" onclick="showDetail(${realIdx})">
          <div class="rank-badge ${rankClass}">${i + 1}</div>
          ${isNew ? '<div class="new-label">NEW</div>' : ''}
          <div class="feat-thumb-wrapper">
            <img src="${a.thumbnail}" alt="${a.title}" loading="lazy" onerror="this.style.display='none';this.nextElementSibling.style.display='flex';" />
            <div class="no-thumb" style="display:none;">
              <svg xmlns="http://www.w3.org/2000/svg" width="36" height="36" fill="none" viewBox="0 0 24 24" stroke="currentColor" style="opacity:0.5;"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M2.25 15.75l5.159-5.159a2.25 2.25 0 013.182 0l5.159 5.159m-1.5-1.5l1.409-1.409a2.25 2.25 0 013.182 0l2.909 2.909M3.75 21h16.5a1.5 1.5 0 001.5-1.5V6a1.5 1.5 0 00-1.5-1.5H3.75A1.5 1.5 0 002.25 6v13.5A1.5 1.5 0 003.75 21z"/></svg>
              <span>ç”»åƒãªã—</span>
            </div>
          </div>
          <div class="feat-body">
            <h3>${a.title}</h3>
            <div class="feat-desc">${a.description}</div>
            <div class="feat-meta">${a.published}ã€€${a.category}</div>
            <div class="feat-actions">
              <a href="${a.cmsUrl}" target="_blank" class="primary" onclick="event.stopPropagation();">è¨˜äº‹ã‚’é–‹ã</a>
              <a href="output/${a.file}" target="_blank" class="secondary" onclick="event.stopPropagation();">MDè¡¨ç¤º</a>
            </div>
          </div>
        </div>
        `;
      }).join('');
    }

    function showToast(message, isError) {
      const existing = document.querySelector('.toast');
      if (existing) existing.remove();

      const toast = document.createElement('div');
      toast.className = 'toast';
      if (isError) toast.style.background = 'var(--red)';
      toast.textContent = message;
      document.body.appendChild(toast);
      setTimeout(() => toast.remove(), 3000);
    }

    function render() {
      const container = document.getElementById('article-container');
      container.className = currentView === 'grid' ? 'grid-view' : 'list-view';

      const popular = getPopularSet();
      const pinned = getPinnedSet();

      let filtered = articles;
      if (currentFilter === 'popular') {
        filtered = articles.filter(a => popular.has(a.file));
      } else if (currentFilter === 'pinned') {
        filtered = articles.filter(a => pinned.has(a.file));
      } else if (currentFilter === 'has-thumb') {
        filtered = articles.filter(a => a.cmsThumb);
      } else if (currentFilter === 'no-thumb') {
        filtered = articles.filter(a => !a.cmsThumb);
      } else if (currentFilter !== 'all') {
        filtered = articles.filter(a => a.category.includes(currentFilter));
      }

      const totalCount = articles.length;
      const thumbCount = articles.filter(a => a.cmsThumb).length;
      const popularCount = articles.filter(a => popular.has(a.file)).length;
      const pinnedCount = articles.filter(a => pinned.has(a.file)).length;
      document.getElementById('total-count').textContent = totalCount;
      document.getElementById('thumb-count').textContent = thumbCount;
      document.getElementById('no-thumb-count').textContent = totalCount - thumbCount;
      document.getElementById('popular-count').textContent = popularCount;
      document.getElementById('pinned-count').textContent = pinnedCount;

      if (filtered.length === 0) {
        let emptyMsg = 'è©²å½“ã™ã‚‹è¨˜äº‹ãŒã‚ã‚Šã¾ã›ã‚“';
        let emptyHint = '';
        if (currentFilter === 'popular') {
          emptyMsg = 'äººæ°—ã®è¨˜äº‹ãŒã‚ã‚Šã¾ã›ã‚“';
          emptyHint = '<p style="font-size:0.8125rem;margin-top:0.5rem;">ã€Œã™ã¹ã¦ã€ã‚¿ãƒ–ã«æˆ»ã‚Šã€å„ã‚«ãƒ¼ãƒ‰ã® <strong>ğŸ”¥ äººæ°—</strong> ãƒœã‚¿ãƒ³ã§è¨˜äº‹ã‚’è¿½åŠ ã—ã¦ãã ã•ã„</p>';
        } else if (currentFilter === 'pinned') {
          emptyMsg = 'ãŠã™ã™ã‚ã«ãƒ”ãƒ³ç•™ã‚ã•ã‚ŒãŸè¨˜äº‹ãŒã‚ã‚Šã¾ã›ã‚“';
          emptyHint = '<p style="font-size:0.8125rem;margin-top:0.5rem;">ã€Œã™ã¹ã¦ã€ã‚¿ãƒ–ã«æˆ»ã‚Šã€å„ã‚«ãƒ¼ãƒ‰ã® <strong>ğŸ“Œ ãŠã™ã™ã‚</strong> ãƒœã‚¿ãƒ³ã§è¨˜äº‹ã‚’ãƒ”ãƒ³ç•™ã‚ã—ã¦ãã ã•ã„</p>';
        }
        container.innerHTML = `
          <div class="empty-state">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 00-9-9z"/></svg>
            <p>${emptyMsg}</p>
            ${emptyHint}
          </div>
        `;
        return;
      }

      container.innerHTML = filtered.map((a) => {
        const realIdx = articles.indexOf(a);
        const isPop = popular.has(a.file);
        const isPin = pinned.has(a.file);
        const cardClasses = ['card'];
        if (isPop) cardClasses.push('is-popular');
        if (isPin) cardClasses.push('is-pinned');

        let badgesHtml = '';
        if (isPop || isPin) {
          badgesHtml = '<div class="card-badges">';
          if (isPop) badgesHtml += '<span class="badge-item badge-popular">ğŸ”¥ äººæ°—</span>';
          if (isPin) badgesHtml += '<span class="badge-item badge-pinned">ğŸ“Œ ãŠã™ã™ã‚</span>';
          badgesHtml += '</div>';
        }

        return `
        <div class="${cardClasses.join(' ')}" onclick="showDetail(${realIdx})">
          <div class="thumbnail-wrapper">
            ${badgesHtml}
            <img src="${a.thumbnail}" alt="${a.title}" loading="lazy" onerror="this.style.display='none';this.nextElementSibling.style.display='flex';" />
            <div class="no-thumb" style="display:none;">
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M2.25 15.75l5.159-5.159a2.25 2.25 0 013.182 0l5.159 5.159m-1.5-1.5l1.409-1.409a2.25 2.25 0 013.182 0l2.909 2.909M3.75 21h16.5a1.5 1.5 0 001.5-1.5V6a1.5 1.5 0 00-1.5-1.5H3.75A1.5 1.5 0 002.25 6v13.5A1.5 1.5 0 003.75 21z"/></svg>
              <span>ç”»åƒãªã—</span>
            </div>
            <span class="status-badge published">å…¬é–‹ä¸­</span>
            ${a.cmsThumb
              ? '<span class="thumb-indicator has-thumb">CMSè¨­å®šæ¸ˆã¿</span>'
              : '<span class="thumb-indicator no-thumb-badge">CMSæœªè¨­å®š</span>'
            }
          </div>
          <div class="card-body">
            <h3>${a.title}</h3>
            <div class="meta">
              <span>${a.published}</span>
              <span>${a.category}</span>
            </div>
            <div class="tags">
              ${a.keyword.split(/[, ]+/).map(k => `<span>#${k}</span>`).join('')}
            </div>
            <div class="description">${a.description}</div>
            <div class="actions">
              <a href="${a.cmsUrl}" target="_blank" class="primary" onclick="event.stopPropagation();">è¨˜äº‹ã‚’é–‹ã</a>
              <a href="output/${a.file}" target="_blank" class="secondary" onclick="event.stopPropagation();">MDè¡¨ç¤º</a>
              <span class="spacer"></span>
              <button class="toggle-btn ${isPop ? 'popular-active' : ''}" onclick="togglePopular('${a.file}', event)" title="${isPop ? 'äººæ°—ã‚’è§£é™¤' : 'äººæ°—ã«è¿½åŠ '}">
                ğŸ”¥ ${isPop ? 'äººæ°—' : 'äººæ°—'}
              </button>
              <button class="toggle-btn ${isPin ? 'pin-active' : ''}" onclick="togglePinned('${a.file}', event)" title="${isPin ? 'ãŠã™ã™ã‚è§£é™¤' : 'ãŠã™ã™ã‚ã«ãƒ”ãƒ³ç•™ã‚'}">
                ğŸ“Œ ${isPin ? 'ãŠã™ã™ã‚' : 'ãŠã™ã™ã‚'}
              </button>
            </div>
          </div>
        </div>
        `;
      }).join('');
    }

    initPopularIfNeeded();
    render();
    renderFeatured();
  </script>
</body>
</html>
